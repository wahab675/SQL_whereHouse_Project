


 INSERT INTO silver.crm_cust_info(
cst_id,
cst_key,
cst_firstname,
cst_gndr,
cst_marital_status,
cst_create_date,
cst_lastname
)
 select
 cst_id,
 cst_key,
 trim(cst_firstname) as first_name,
 case when Upper(trim( cst_gndr)) ='F' then 'Female'
 when upper(trim( cst_gndr))='M' then 'Male'
 else 'other'
 end cst_gender,

 case when Upper(trim( cst_marital_status)) ='S' then 'Single'
 when upper(trim( cst_marital_status))='M' then 'Marride'
 else 'other'
 end cst_marital_status,

 cst_create_date,
 TRIM(cst_lastname)as ast_name
 from(
select *, ROW_NUMBER() over (partition by cst_id order by cst_create_date desc)as flag_last from bronze.crm_cust_info
)as t where flag_last =1;
